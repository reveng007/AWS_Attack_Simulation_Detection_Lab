# 13.SOCLabs: Bulk Remote Sessions Across Multiple EC2 Instances via SSM StartSession

https://www.soc-labs.top/en/detections/93

## Goal: 
Write a detection rule to identify bulk SSM StartSession requests targeting multiple EC2 instances within a short timeframe.

## Detailed Reasoning :

1. Searched here: https://docs.aws.amazon.com/ (for: `ssm`)
2. Searched here: https://docs.aws.amazon.com/systems-manager/latest/APIReference/API_Operations.html (for: `StartSession`)
3. Jotted down links:
    - https://docs.aws.amazon.com/systems-manager/latest/APIReference/API_StartSession.html

## Sigma Query:
```yaml
title: Bulk Remote Sessions Across Multiple Instances via SSM StartSession
status: test
description: Bulk Remote Sessions Across Multiple Instances via SSM StartSession
references:
    - https://docs.aws.amazon.com/systems-manager/latest/APIReference/API_StartSession.html
author: Soumyanil Biswas
date: 2025-10-18
modified: 2025-10-18
tags:
    - attack.xxxx
logsource:
    product: aws
    service: cloudtrail
detection:
    selection:
        eventSource: ssm.amazonaws.com
        eventType: AwsApiCall
        
        eventName: StartSession

    condition: selection 
falsepositives:
    - unknown
level: high
fields:
    - eventName
    - sourceIPAddress
    - eventID
    - eventSource
    - userIdentity.arn
```

## Query Result:

<img width="1812" height="412" alt="image" src="https://github.com/user-attachments/assets/674c6192-24f7-4517-b374-e5166510a9b2" />

